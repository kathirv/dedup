@model IEnumerable<Dedup.ViewModels.ConnectorConfig>

    @{
        ViewData["Title"] = "Dedup Data Steward";
    }


    @section styles{
        <link rel="stylesheet" href="~/css/pioneerpagenation.min.css" />
        <style type="text/css">
            .expand {
                -webkit-transform: rotate(-90deg);
                -ms-transform: rotate(-90deg);
                -moz-transform: rotate(-90deg);
                -o-transform: rotate(-90deg);
                display: block;
                font-size: 20px;
                font-weight: bold;
            }

            .collapse {
                -webkit-transform: rotate(90deg);
                -ms-transform: rotate(-90deg);
                -moz-transform: rotate(-90deg);
                -o-transform: rotate(-90deg);
                display: block;
                font-size: 20px;
                font-weight: bold;
            }

            table {
                margin: 0 auto;
                width: 100%;
                clear: both;
                border-collapse: collapse;
                table-layout: fixed;
                word-wrap: break-word;
            }

            th, td {
                /*            white-space: nowrap;
            */
                width: 158px;
            }

            #kt_table_1 tr > *:nth-child(1) {
                width: 62px !important;
            }

            #kt_table_2 tr > *:nth-child(1) {
                width: 40px !important;
            }

            #kt_table_3 tr > *:nth-child(1) {
                width: 26px !important;
            }

            /*#kt_table_3 tr > *:nth-child(2) {
                width: 26px !important;
            }*/
        </style>
    }

    @if (Model != null && Model.Count() > 0)
    {
        foreach (var item in Model.Select((value, i) => new { i, value }))
        {
            <div class="row" name="etrows" id="@item.value.connectorId" data-isrowsread="@(item.i == 0 ? true : false)">
                @await Component.InvokeAsync("PGRows", new { id = item.value.connectorId, page = 1, isRowsRead = (item.i == 0 ? true : false), connectorConfig = item.value, pagesize = ViewBag.pagesize})
            </div>
        }
    }

    @section Scripts{
        <script type="text/javascript">
            var connectorid = $("#connectorid")[0].innerText;

            var params = new window.URLSearchParams(window.location.search);
            var ctid = params.get('ctid');

            // localStorage.clear();
            var pagesize = localStorage.getItem("pagesize");
            if (pagesize == null) {

                pagesize = "10";
            }
            pagesize = parseInt(pagesize);
            if ($(".current")[0] != undefined) {
                var currentpage = $(".current")[0].innerText;
                localStorage.setItem("currentpage", currentpage);
            }

            function checkrecords() {

                $('input[type=checkbox]').change(function () {

                    var checboxlength = $('input[type="checkbox"]').length;
                    var count = 0;
                    for (var i = 0; i < checboxlength; i++) {

                        if ($('input[type="checkbox"]')[i].checked == true) {

                            count++;
                        }
                    }
                    if ($("#tabs .ui-tabs-active").text() == "Unique Records") {
                        $("#deleteuniquerecord").html("Record selected for delete: " + count);

                        if (count > 0) {

                            $('a[name=deleteselectedrecord]').css('opacity', '1');
                            $('a[name=deleteselectedrecord]').css('cursor', 'pointer');

                        }
                        else {
                            $('a[name=deleteselectedrecord]').css('opacity', '0.1');
                            $('a[name=deleteselectedrecord]').css('cursor', 'none');

                        }
                    }
                    else {

                        $("#deleteduplicaterecord").html("Record selected for delete: " + count);

                        if (count > 0) {

                            $('a[name=deleteduplicateselectedrecord]').css('opacity', '1');
                            $('a[name=deleteduplicateselectedrecord]').css('cursor', 'pointer');

                        }
                        else {
                            $('a[name=deleteduplicateselectedrecord]').css('opacity', '0.1');
                            $('a[name=deleteduplicateselectedrecord]').css('cursor', 'none');

                        }
                    }

                });

                $('#SelectAll').click(function (e) {
                    var recordsLength = $("input[name=deletechildrecord]").length;
                    for (var i = 0; i < recordsLength; i++) {
                        var record = $("input[name=deletechildrecord]")[i];
                        if ($(record).closest("td").data("dt-row") != undefined) {
                            if ($("input[name=deletechildrecord]")[i].id != "parentrecord") {
                                //alert($(record).closest("td").data("dt-row"));
                                $("input[name=deletechildrecord]")[i].checked = true;

                            }
                        }
                    }
                    var checboxlength = $('input[type="checkbox"]').length;
                    var count = 0;
                    for (var i = 0; i < checboxlength; i++) {

                        if ($('input[type="checkbox"]')[i].checked == true) {

                            count++;
                        }
                    }
                    $("#deleteduplicaterecord").html("Record selected for delete: " + count);

                    if (count > 0) {

                        $('a[name=deleteduplicateselectedrecord]').css('opacity', '1');
                        $('a[name=deleteduplicateselectedrecord]').css('cursor', 'pointer');

                    }
                });
                $('#DeselectAll').click(function (e) {

                    var recordsLength = $("input[name=deletechildrecord]").length;
                    for (var i = 0; i < recordsLength; i++) {
                        var record = $("input[name=deletechildrecord]")[i];

                        if ($(record).closest("td").data("dt-row") != undefined) {
                            if ($("input[name=deletechildrecord]")[i].id != "parentrecord") {

                                $("input[name=deletechildrecord]")[i].checked = false;

                            }
                        }
                    }

                    var checboxlength = $('input[type="checkbox"]').length;
                    var count = 0;
                    for (var i = 0; i < checboxlength; i++) {

                        if ($('input[type="checkbox"]')[i].checked == true) {

                            count++;
                        }
                    }
                    $("#deleteduplicaterecord").html("Record selected for delete: " + count);

                    if (count > 0) {

                        $('a[name=deleteduplicateselectedrecord]').css('opacity', '1');
                        $('a[name=deleteduplicateselectedrecord]').css('cursor', 'pointer');

                    }
                    else {
                        $('a[name=deleteduplicateselectedrecord]').css('opacity', '0.1');
                        $('a[name=deleteduplicateselectedrecord]').css('cursor', 'none');

                    }
                });
            }
            function getTabs(ctid) {
                $("#tabs").tabs();

                var first_tab = $("#tabs")[0].children[0].children[0].children[0].id
                var second_tab = $("#tabs")[0].children[0].children[1].children[0].id

                var third_tab = $("#tabs")[0].children[0].children[2].children[0].id
                if (ctid == null || ctid == "" || ctid == "undefined") {

                    $("#" + third_tab).hide()
                    $(".fa-times").hide();
                }
                var totalrecords = $("#totalrecordcount").text().trim();
                if (parseInt(totalrecords) > 0) {
                    if ($("#kt_table_1 > thead > tr")[0].children.length > 7) {

                        $('#kt_table_1').DataTable(
                            {
                                paging: false,
                                searching: false,
                                scrollX: true,
                                autoWidth: false,
                                stateSave: true,
                                //columnDefs: [
                                //    {
                                //        orderable: false
                                //    }]
                                columnDefs: [
                                    {
                                        orderable: false,
                                        targets: 0
                                    }
                                ],
                                //scrollCollapse: true,

                                fixedColumns: {
                                    leftColumns: 1

                                },
                                order: [[1, 'asc']]
                            });


                        $('.dataTables_scrollBody')[0].style.overflowX = "scroll";


                    }
                    else {
                        $('#kt_table_1').DataTable(
                            {
                                // responsive: true,
                                paging: false,
                                searching: false,
                                scrollX: true,
                                autoWidth: false,
                                stateSave: true,

                                //columnDefs: [
                                //    {
                                //        orderable: false
                                //    }]
                                columnDefs: [
                                    {
                                        orderable: false,
                                        targets: 0
                                    }
                                ],

                                order: [[1, 'asc']]
                            });



                    }

                    if ($("#kt_table_2 > thead > tr")[0].children.length > 7) {



                        $('#kt_table_2').DataTable(
                            {
                                //scrollY: "300px",
                                scrollX: true,
                                scrollCollapse: true,
                                paging: false,
                                fixedColumns: true,
                                searching: false,
                                stateSave: true,

                                //fixedHeader: false,
                            });


                        $('.dataTables_scrollBody')[1].style.overflowX = "scroll";

                    }
                    else {

                        $('#kt_table_2').DataTable(
                            {

                                paging: false,
                                searching: false,
                                scrollX: true,
                                autoWidth: false,
                                stateSave: true,

                                columnDefs: [
                                    {
                                        orderable: false,
                                        targets: 0
                                    }
                                ],

                                order: [[1, 'asc']]
                            });

                    }



                    var headerrow = $("table > thead > tr")[0];

                    headerrow.children[0].className = "";
                    headerrow.children[0].style.width = "62px";

                    if ($("#kt_table_3 > thead > tr")[0].children.length > 7) {



                        $('#kt_table_3').DataTable(
                            {
                                //scrollY: "300px",
                                scrollX: true,
                                scrollCollapse: true,
                                paging: false,
                                order: [],
                                fixedColumns: {
                                    leftColumns: 1

                                },
                                fixedHeader: {
                                    leftColumns: 1,
                                    topRows: 1
                                },
                                searching: false,

                                //fixedHeader: false,
                            });
                        $('.dataTables_scrollBody')[2].style.overflowX = "scroll";

                        //$("#kt_table_3").DataTable().columns.adjust().draw();
                        //$("#kt_table_3").DataTable().draw();

                    }
                    else {

                        $('#kt_table_3').DataTable(
                            {

                                paging: false,
                                searching: false,
                                scrollX: true,
                                autoWidth: false,
                                stateSave: true,

                                columnDefs: [
                                    {
                                        orderable: false,
                                        targets: 0
                                    }
                                ],

                                order: [[1, 'asc']]
                            });

                    }

                    if (ctid == null || ctid == "" || ctid == "undefined") {
                        $("#" + third_tab).hide()
                        $(".fa-times").hide();
                        $("#tabs").tabs({ disabled: [] });
                    }
                    else {
                        //$('#ui-id-3').trigger('click');

                        $("#tabs").tabs({ disabled: [0, 1] });
                        $("#" + third_tab).show()
                        $(".fa-times").show();
                        $("#" + third_tab).trigger('click');
                        //$("#" + third_tab).parent()[0].style.height = "25px"
                        var row = $("#kt_table_3").children('tbody').children('tr:first')[0];

                        var rowlength = row.children.length;
                        if (row.children[rowlength - 1].innerText.trim() == ctid) {
                            row.style.fontWeight = "600";
                            var firstcolumnchild = row.children[0];
                            //var secondcolumnchild = row.children[1];
                            firstcolumnchild.children[0].disabled = true;
                            firstcolumnchild.children[0].id = "parentrecord";
                            //firstcolumnchild.children[0].title = "To delete this, you must assign another record from the list as golden record";
                            //secondcolumnchild.children[0].style.color = "yellow";
                            //secondcolumnchild.children[0].title = "";
                            //secondcolumnchild.children[0].src = "/images/noun_unique_385004_black.png"
                        }

                    }
                    updatePaging($("div[name=etrows]"));
                }
                if ($(".box-body .header").first().length > 0)
                    $(".box-body .header").first().click();

                var marked_for_delete_count = parseInt($("#marked_for_delete_count")[0].innerText);

                $('th, #kt_table_3_paginate').on('click', function (e) {
                    checkrecords();
                    var headerrow = $("table > thead > tr")[0];

                    headerrow.children[0].className = "";
                    headerrow.children[0].style.width = "62px";
                    if ($("#kt_table_1 > thead > tr")[0].children.length > 7) {

                        $('.dataTables_scrollBody')[0].style.width = "1280px";
                        $('.dataTables_scrollHead')[0].style.width = "1280px";

                        var headerrow = $("table > thead > tr")[0];

                        headerrow.children[0].className = "";
                        headerrow.children[0].style.width = "62px";
                    }
                    var headerrow = $("table > thead > tr")[2];

                    headerrow.children[0].className = "";
                    headerrow.children[0].style.width = "40px";
                    var checboxlength = $('input[type="checkbox"]').length;

                    for (var i = 0; i < checboxlength; i++) {

                        if ($('input[type="checkbox"]')[i].checked == true) {

                            $('input[type="checkbox"]')[i].checked = false;
                        }
                    }

                    $('a[name=deleteselectedrecord]').css('opacity', '0.1');
                    $('a[name=deleteselectedrecord]').css('cursor', 'none');
                    $("#deleteuniquerecord").html("Records selected for delete: 0");
                    $('a[name=deleteduplicateselectedrecord]').css('opacity', '0.1');
                    $('a[name=deleteduplicateselectedrecord]').css('cursor', 'none');
                    $("#deleteduplicaterecord").html("Records selected for delete: 0");

                    $("#kt_table_2").DataTable().columns.adjust().draw();
                    $("#kt_table_2").DataTable().draw();

                    if ($("#kt_table_2 > thead > tr")[0].children.length > 7) {
                        $('.dataTables_scrollBody')[1].style.width = "1280px";
                        $('.dataTables_scrollHead')[1].style.width = "1280px";
                        var length = $(".DTFC_Cloned > thead > tr > th").length;
                        for (var i = 0; i < length; i++) {

                            if ($(".DTFC_Cloned > thead > tr > th")[i].getAttribute('aria-controls') == "kt_table_2" && $(".DTFC_Cloned > thead > tr > th")[i].style.paddingTop != "0px") {
                                $(".DTFC_Cloned > thead > tr > th")[i].className = "";


                            }
                        }
                        var length2 = $(".DTFC_LeftBodyLiner").children().length;
                        for (var j = 0; j < length2; j++) {

                            if ($(".DTFC_LeftBodyLiner").children()[j].getAttribute('aria-describedby') == "kt_table_2_info") {
                                var fixedcolumn = $(".DTFC_LeftBodyLiner").children()[j];
                                fixedcolumn.children[0].children[0].children[0].className = "";
                            }
                        }

                    }
                    if ($("#kt_table_3 > thead > tr")[0].children.length > 7) {

                        $('.dataTables_scrollBody')[2].style.width = "1280px";
                        $('.dataTables_scrollHead')[2].style.width = "1280px";

                        var length = $(".DTFC_Cloned > thead > tr > th").length;
                        for (var i = 0; i < length; i++) {

                            if ($(".DTFC_Cloned > thead > tr > th")[i].getAttribute('aria-controls') == "kt_table_3" && $(".DTFC_Cloned > thead > tr > th")[i].style.paddingTop != "0px") {
                                $(".DTFC_Cloned > thead > tr > th")[i].className = "";


                            }
                        }
                        var length2 = $(".DTFC_LeftBodyLiner").children().length;
                        for (var j = 0; j < length2; j++) {

                            if ($(".DTFC_LeftBodyLiner").children()[j].getAttribute('aria-describedby') == "kt_table_3_info") {
                                var fixedcolumn = $(".DTFC_LeftBodyLiner").children()[j];
                                fixedcolumn.children[0].children[0].children[0].className = "";
                                //fixedcolumn.children[0].children[0].children[1].className = "";

                            }
                        }

                    }

                    var currentpage = parseInt($(".current")[0].innerText);
                    var totalrecords = $("#totalrecordcount").text().trim();
                    if ($("#tabs .ui-tabs-active").text() == "Unique Records") {
                        var pagesize = $('#UniqueRecords :selected').text();
                    }
                    else if ($("#tabs .ui-tabs-active").text() == "Duplicate Records") {
                        var pagesize = $('#DuplicateRecords :selected').text();
                    }
                    else {
                        var pagesize = $('#Records :selected').text();

                    }
                    var currentpagerecord = currentpage * pagesize;

                    if (currentpagerecord > totalrecords) {

                        currentpagerecord = totalrecords;
                    }
                    $("#kt_table_1_info").text("Showing " + (currentpage * pagesize - pagesize + 1) + " to " + currentpagerecord + " of " + totalrecords + " entries");
                    $("#kt_table_2_info").text("Showing " + (currentpage * pagesize - pagesize + 1) + " to " + currentpagerecord + " of " + totalrecords + " entries");
                    $("#kt_table_3_info").text("Showing " + (currentpage * pagesize - pagesize + 1) + " to " + currentpagerecord + " of " + totalrecords + " entries");

                })

                $('#kt_table_2_paginate').on('click', function (e) {
                    checkrecords();
                    //$("#kt_table_2").DataTable().columns.adjust().draw();

                    //var headerrow = $("table > thead > tr")[2];

                    //headerrow.children[0].className = "";
                    //headerrow.children[0].style.width = "52px";
                    var checboxlength = $('input[type="checkbox"]').length;

                    for (var i = 0; i < checboxlength; i++) {

                        if ($('input[type="checkbox"]')[i].checked == true) {

                            $('input[type="checkbox"]')[i].checked = false;
                        }
                    }

                    $('a[name=deleteselectedrecord]').css('opacity', '0.1');
                    $('a[name=deleteselectedrecord]').css('cursor', 'none');
                    $("#deleteuniquerecord").html("Records selected for delete: 0");
                    //$("#kt_table_2").DataTable().columns.adjust().draw();
                    //$("#kt_table_2").DataTable().draw();

                    if ($("#kt_table_2 > thead > tr")[0].children.length > 7) {
                        $('.dataTables_scrollBody')[1].style.width = "1280px";
                        $('.dataTables_scrollHead')[1].style.width = "1280px";

                        var length = $(".DTFC_Cloned > thead > tr > th").length;
                        for (var i = 0; i < length; i++) {

                            if ($(".DTFC_Cloned > thead > tr > th")[i].getAttribute('aria-controls') == "kt_table_2" && $(".DTFC_Cloned > thead > tr > th")[i].style.paddingTop != "0px") {
                                $(".DTFC_Cloned > thead > tr > th")[i].className = "";


                            }
                        }
                        var length2 = $(".DTFC_LeftBodyLiner").children().length;
                        for (var j = 0; j < length2; j++) {

                            if ($(".DTFC_LeftBodyLiner").children()[j].getAttribute('aria-describedby') == "kt_table_2_info") {
                                var fixedcolumn = $(".DTFC_LeftBodyLiner").children()[j];
                                fixedcolumn.children[0].children[0].children[0].className = "";
                            }
                        }


                    }

                })


                $('select[name = kt_table_1_length]').change(function (e) {
                    var headerrow = $("table > thead > tr")[0];

                    headerrow.children[0].className = "";
                    headerrow.children[0].style.width = "62px";
                });
                $('select[name = kt_table_2_length]').change(function (e) {

                    checkrecords();
                    var headerrow = $("table > thead > tr")[2];

                    headerrow.children[0].className = "";
                    headerrow.children[0].style.width = "40px";
                    var checboxlength = $('input[type="checkbox"]').length;

                    for (var i = 0; i < checboxlength; i++) {

                        if ($('input[type="checkbox"]')[i].checked == true) {

                            $('input[type="checkbox"]')[i].checked = false;
                        }
                    }
                    $('a[name=deleteselectedrecord]').css('opacity', '0.1');
                    $('a[name=deleteselectedrecord]').css('cursor', 'none');
                    $("#deleteuniquerecord").html("Records selected for delete: 0");
                    $("#kt_table_2").DataTable().columns.adjust().draw();
                    $("#kt_table_2").DataTable().draw();

                    if ($("#kt_table_2 > thead > tr")[0].children.length > 7) {
                        $('.dataTables_scrollBody')[1].style.width = "1280px";
                        $('.dataTables_scrollHead')[1].style.width = "1280px";

                        var length = $(".DTFC_Cloned > thead > tr > th").length;
                        for (var i = 0; i < length; i++) {

                            if ($(".DTFC_Cloned > thead > tr > th")[i].getAttribute('aria-controls') == "kt_table_2" && $(".DTFC_Cloned > thead > tr > th")[i].style.paddingTop != "0px") {
                                $(".DTFC_Cloned > thead > tr > th")[i].className = "";


                            }
                        }
                        var length2 = $(".DTFC_LeftBodyLiner").children().length;
                        for (var j = 0; j < length2; j++) {

                            if ($(".DTFC_LeftBodyLiner").children()[j].getAttribute('aria-describedby') == "kt_table_2_info") {
                                var fixedcolumn = $(".DTFC_LeftBodyLiner").children()[j];
                                fixedcolumn.children[0].children[0].children[0].className = "";
                            }
                        }

                    }
                });

                $('select[name = kt_table_3_length]').change(function (e) {

                    checkrecords();
                    var checboxlength = $('input[type="checkbox"]').length;

                    for (var i = 0; i < checboxlength; i++) {

                        if ($('input[type="checkbox"]')[i].checked == true) {

                            $('input[type="checkbox"]')[i].checked = false;
                        }
                    }
                    $('a[name=deleteduplicateselectedrecord]').css('opacity', '0.1');
                    $('a[name=deleteduplicateselectedrecord]').css('cursor', 'none');
                    $("#deleteduplicaterecord").html("Records selected for delete: 0");

                    if ($("#kt_table_3 > thead > tr")[0].children.length > 7) {

                        $('.dataTables_scrollBody')[2].style.width = "1280px";
                        $('.dataTables_scrollHead')[2].style.width = "1280px";

                        var length = $(".DTFC_Cloned > thead > tr > th").length;
                        for (var i = 0; i < length; i++) {

                            if ($(".DTFC_Cloned > thead > tr > th")[i].getAttribute('aria-controls') == "kt_table_3" && $(".DTFC_Cloned > thead > tr > th")[i].style.paddingTop != "0px") {
                                $(".DTFC_Cloned > thead > tr > th")[i].className = "";


                            }
                        }
                        var length2 = $(".DTFC_LeftBodyLiner").children().length;
                        for (var j = 0; j < length2; j++) {

                            if ($(".DTFC_LeftBodyLiner").children()[j].getAttribute('aria-describedby') == "kt_table_3_info") {
                                var fixedcolumn = $(".DTFC_LeftBodyLiner").children()[j];
                                fixedcolumn.children[0].children[0].children[0].className = "";
                                fixedcolumn.children[0].children[0].children[1].className = "";

                            }
                        }
                    }
                });

                $("#" + first_tab).on("click", function (e) {
                    var checboxlength = $('input[type="checkbox"]').length;

                    for (var i = 0; i < checboxlength; i++) {

                        if ($('input[type="checkbox"]')[i].checked == true) {

                            $('input[type="checkbox"]')[i].checked = false;
                        }
                    }
                    $('a[name=deleteselectedrecord]').css('opacity', '0.1');
                    $('a[name=deleteselectedrecord]').css('cursor', 'none');
                    $("#deleteuniquerecord").html("Records selected for delete: 0");
                    var pagesize = localStorage.getItem("pagesize");
                    if (pagesize == null) {

                        pagesize = "10";
                    }
                    var currentpage = localStorage.getItem("currentpage");
                    if (currentpage == null) {

                        currentpage = "1";
                    }
                    if ($("#totalrecordcount").text().trim() != "") {
                        $("#kt_table_1").DataTable().columns.adjust().draw();
                        $("#kt_table_1").DataTable().draw();
                        //var pagesize = $('#UniqueRecords :selected').text();

                    }
                    showMask();
                    $.ajax({
                        url: "/connector/GetUniqueAndDuplicate/" + parseInt(connectorid) + "?pagesize=" + parseInt(pagesize) + "&currentpage=" + parseInt(currentpage),
                        method: "GET",
                        error: function (xhr, status, error) {
                            hideMask();
                            console.log(xhr);
                            console.log(status);
                            if (status == "timeout") {
                                container.find("tr[name=emptyrow] td").html("Request timeout!");
                            }
                        },
                        success: function (data) {
                            var container = $("div[name=etrows]");
                            container.html("");
                            container.html(data);
                            //container.attr("data-isrowsread", "true");
                            $("#tabs").tabs({ active: 0 });
                            var ctid = "";
                            $('#Records').val(pagesize);
                            $("#UniqueRecords").val(pagesize);
                            getTabs(ctid);
                            checkrecords();


                            hideMask();
                        }
                    });
                });
                $("#" + second_tab).on("click", function (e) {
                    //alert();
                    var pagesize = localStorage.getItem("pagesize2");

                    if (pagesize == null) {

                        pagesize = "10";
                    }
                    if ($("#totalrecordcount").text().trim() != "") {
                        $("#kt_table_2").DataTable().columns.adjust().draw();
                        $("#kt_table_2").DataTable().draw();
                        //var pagesize = $('#UniqueRecords :selected').text();

                    }

                    showMask();
                    $.ajax({
                        url: "/connector/GetUniqueAndDuplicate/" + parseInt(connectorid) + "?tab=" + second_tab + "&pagesize=" + parseInt(pagesize),
                        method: "GET",
                        error: function (xhr, status, error) {
                            hideMask();
                            console.log(xhr);
                            console.log(status);
                            if (status == "timeout") {
                                container.find("tr[name=emptyrow] td").html("Request timeout!");
                            }
                        },
                        success: function (data) {
                            var container = $("div[name=etrows]");
                            container.html("");
                            container.html(data);
                            //container.attr("data-isrowsread", "true");
                            $("#tabs").tabs({ active: 1 });
                            $('#Records').val(pagesize);
                            $("#UniqueRecords").val(pagesize);
                            //$('#UniqueRecords').val(pagesize);
                            var ctid = "";
                            getTabs(ctid);
                            checkrecords();
                            //$('#UniqueRecords').val(pagesize);
                            if ($("#totalrecordcount").text().trim() != "") {
                                $("#kt_table_2").DataTable().columns.adjust().draw();
                                $("#kt_table_2").DataTable().draw();
                                var headerrow = $("table > thead > tr")[2];

                                headerrow.children[0].className = "";
                                headerrow.children[0].style.width = "40px";
                                $("#kt_table_2").DataTable().columns.adjust().draw();
                                $("#kt_table_2").DataTable().draw();
                                if ($("#kt_table_2 > thead > tr")[0].children.length > 7) {
                                    $('.dataTables_scrollBody')[1].style.width = "1280px";
                                    $('.dataTables_scrollHead')[1].style.width = "1280px";

                                    var length = $(".DTFC_Cloned > thead > tr > th").length;
                                    for (var i = 0; i < length; i++) {

                                        if ($(".DTFC_Cloned > thead > tr > th")[i].getAttribute('aria-controls') == "kt_table_2" && $(".DTFC_Cloned > thead > tr > th")[i].style.paddingTop != "0px") {
                                            $(".DTFC_Cloned > thead > tr > th")[i].className = "";


                                        }
                                    }
                                    var length2 = $(".DTFC_LeftBodyLiner").children().length;
                                    for (var j = 0; j < length2; j++) {

                                        if ($(".DTFC_LeftBodyLiner").children()[j].getAttribute('aria-describedby') == "kt_table_2_info") {
                                            var fixedcolumn = $(".DTFC_LeftBodyLiner").children()[j];
                                            fixedcolumn.children[0].children[0].children[0].className = "";

                                        }
                                    }
                                }
                                var currentpage = parseInt($(".current")[0].innerText);
                                var totalrecords = $("#totalrecordcount").text().trim();

                                var currentpagerecord = currentpage * pagesize;

                                if (currentpagerecord > totalrecords) {

                                    currentpagerecord = totalrecords;
                                }
                                $("#kt_table_2_info").text("Showing " + (currentpage * pagesize - pagesize + 1) + " to " + currentpagerecord + " of " + totalrecords + " entries");
                            }
                            hideMask();
                        }
                    });
                })

                $('a[name=deleteselectedrecord]').on("click", function (e) {
                    if ($('a[name=deleteselectedrecord]')[0].style.opacity == 1) {
                        var checboxlength = $('input[type="checkbox"]').length;
                        var count = 0;
                        for (var i = 0; i < checboxlength; i++) {

                            if ($('input[type="checkbox"]')[i].checked == true) {

                                count++;
                            }
                        }
                        var checkitemsctid = [];


                        for (var i = 0; i < checboxlength; i++) {

                            if ($('input[type="checkbox"]')[i].checked == true) {

                                var parentrow = $('input[type="checkbox"]').parent().parent()[i];

                                var length = parentrow.children.length;

                                var ctidobj = {
                                    ctid: parentrow.children[0].lastElementChild.innerText.trim()
                                }
                                checkitemsctid.push(ctidobj);

                            }
                        }

                        var itemlist = JSON.stringify(checkitemsctid)
                        if ($('a[name=deleteselectedrecord]')[0].text == "Archieve & Delete All Selected Items") {
                            Swal.fire({
                                //title: 'Are you sure?',
                                //closeOnClickOutside: false,
                                allowOutsideClick: false,
                                allowEnterKey: false,
                                closeOnEsc: false,
                                text: "Selected " + count + " items will be Archived and then permanently deleted from Destination",
                                icon: 'error',
                                showCancelButton: true,
                                confirmButtonColor: '#3085d6',
                                cancelButtonColor: '#d33',
                                confirmButtonText: 'Archieve & Delete'
                            }).then((result) => {
                                if (result.value) {
                                    e.preventDefault();
                                    showMask();
                                    if (itemlist.length > 0) {


                                        $.get("/connector/DeleteUniqueRecordsReviewedByUser?id=" + parseInt(connectorid) + "&itemlist=" + itemlist, function (data) {
                                            console.log(data);
                                            //GetChildRecord(parseInt(connectorid), ctid);
                                            //window.location.reload();
                                            $("#" + second_tab).trigger('click');


                                        })
                                        Swal.close();
                                    }
                                }
                            });
                        }
                        else {
                            Swal.fire({
                                //title: 'Are you sure?',
                                text: "Selected " + count + " items will be permanently deleted from Destination since you have not selected the backup option in Process configuration",
                                icon: 'error',
                                showCancelButton: true,
                                confirmButtonColor: '#3085d6',
                                cancelButtonColor: '#d33',
                                confirmButtonText: 'Delete permanently'
                            }).then((result) => {
                                if (result.value) {
                                    e.preventDefault();
                                    showMask();
                                    if (itemlist.length > 0) {

                                        $.get("/connector/DeleteUniqueRecordsReviewedByUser?id=" + parseInt(connectorid) + "&itemlist=" + itemlist, function (data) {
                                            console.log(data);
                                            //window.location.reload();
                                            // GetChildRecord(parseInt(connectorid), ctid);
                                            $("#" + second_tab).trigger('click');


                                        })
                                        Swal.close();

                                    }
                                }
                            });
                        }
                    }
                });

                if ($("#tabs .ui-tabs-active").text() == "Duplicate Groups") {

                    var pagesize = localStorage.getItem("pagesize");
                    if (pagesize == null) {

                        pagesize = "10";
                    }
                    if ($("#kt_table_1 > thead > tr")[0].children.length > 7) {

                        $("#kt_table_1").DataTable().columns.adjust().draw();

                        $('.dataTables_scrollBody')[0].style.width = "1280px";
                        $('.dataTables_scrollHead')[0].style.width = "1280px";

                        var headerrow = $("table > thead > tr")[0];

                        headerrow.children[0].className = "";
                        headerrow.children[0].style.width = "62px";

                        var currentpage = parseInt($(".current")[0].innerText);
                        var totalrecords = $("#totalrecordcount").text().trim();
                        //var pagesize = $('#Records :selected').text();
                        var currentpagerecord = currentpage * pagesize;

                        if (currentpagerecord > totalrecords) {

                            currentpagerecord = totalrecords;
                        }
                        $("#kt_table_1_info").text("Showing " + (currentpage * pagesize - pagesize + 1) + " to " + currentpagerecord + " of " + totalrecords + " entries");


                    }

                }

                if ($("#tabs .ui-tabs-active").text() == "Duplicate Records") {

                    $("#kt_table_3").DataTable().columns.adjust().draw();

                    if ($("#kt_table_3 > thead > tr")[0].children.length > 7) {

                        $('.dataTables_scrollBody')[2].style.width = "1280px";
                        $('.dataTables_scrollHead')[2].style.width = "1280px";

                        var length = $(".DTFC_Cloned > thead > tr > th").length;
                        for (var i = 0; i < length; i++) {

                            if ($(".DTFC_Cloned > thead > tr > th")[i].getAttribute('aria-controls') == "kt_table_3" && $(".DTFC_Cloned > thead > tr > th")[i].style.paddingTop != "0px") {
                                $(".DTFC_Cloned > thead > tr > th")[i].className = "";


                            }
                        }
                        var length2 = $(".DTFC_LeftBodyLiner").children().length;
                        for (var j = 0; j < length2; j++) {

                            if ($(".DTFC_LeftBodyLiner").children()[j].getAttribute('aria-describedby') == "kt_table_3_info") {
                                var fixedcolumn = $(".DTFC_LeftBodyLiner").children()[j];
                                fixedcolumn.children[0].children[0].children[0].className = "";
                                //fixedcolumn.children[0].children[0].children[1].className = "";

                            }
                        }
                    }
                    var currentpage = parseInt($(".current")[0].innerText);
                    var totalrecords = $("#totalrecordcount").text().trim();

                    var pagesize = $('#DuplicateRecords :selected').text();
                    var currentpagerecord = currentpage * pagesize;

                    if (currentpagerecord > totalrecords) {

                        currentpagerecord = totalrecords;
                    }
                    if (totalrecords > pagesize) {
                        if (currentpagerecord == totalrecords) {
                            $("#kt_table_3_info").text("Showing " + (currentpage * pagesize - pagesize + 1) + " to " + currentpagerecord + " of " + totalrecords + " entries");

                        }
                        else {
                            $("#kt_table_3_info").text("Showing " + (currentpage * pagesize - pagesize + 1) + " to " + (currentpagerecord + 1) + " of " + totalrecords + " entries");
                        }
                    }
                    else {
                        $("#kt_table_3_info").text("Showing " + (currentpage * pagesize - pagesize + 1) + " to " + currentpagerecord + " of " + totalrecords + " entries");
                    }

                }
                $('img[name=selectnewParent]').on('click', function (e) {

                    //alert("Select New Parent");

                    if ($(this)[0].src.includes("gray.png")) {

                        // alert("new");

                        var parentrow = $(this).parent().parent()[0]
                        //var newctid = parentrow.children[parentrow.children.length - 1].innerText.trim();
                        var newctid = $(this).parent()[0].lastElementChild.innerText.trim();
                        //alert(newctid);
                        showMask();
                        $.get("/connector/ConfigureNewParentForDuplicates?id=" + parseInt(connectorid) + "&newctid=" + newctid + "&oldctid=" + ctid, function (data) {

                            console.log(data);
                            //window.location.href = "/connector/getrows/" + parseInt(connectorid) + "?ctid=" + newctid;
                            var ctid = newctid;
                            GetChildRecord(parseInt(connectorid), ctid)
                        })
                    }
                })

                $('a[name=deleteduplicateselectedrecord]').on("click", function (e) {
                    if ($('a[name=deleteduplicateselectedrecord]')[0].style.opacity == 1) {
                        var checboxlength = $('input[type="checkbox"]').length;
                        var count = 0;
                        for (var i = 0; i < checboxlength; i++) {

                            if ($('input[type="checkbox"]')[i].checked == true) {

                                count++;
                            }
                        }
                        var checkitemsctid = [];


                        for (var i = 0; i < checboxlength; i++) {

                            if ($('input[type="checkbox"]')[i].checked == true) {

                                var parentrow = $('input[type="checkbox"]').parent().parent()[i];
                                //let obj = {};
                                //obj.ctid = parentrow.children[3].innerText.trim(),

                                //    checitemsctid.push(obj);
                                var length = parentrow.children.length;

                                var ctidobj = {
                                    ctid: parentrow.children[0].lastElementChild.innerText.trim()

                                }
                                //queryStr = { "ctidobj": ctidobj }
                                checkitemsctid.push(ctidobj);

                            }
                        }

                        var itemlist = JSON.stringify(checkitemsctid)
                        if ($('a[name=deleteduplicateselectedrecord]')[0].text == "Archieve & Delete All Selected Items") {
                            Swal.fire({
                                //title: 'Are you sure?',
                                //closeOnClickOutside: false,
                                allowOutsideClick: false,
                                allowEnterKey: false,
                                closeOnEsc: false,
                                text: "Selected " + count + " items will be Archived and then permanently deleted from Destination",
                                icon: 'error',
                                showCancelButton: true,
                                confirmButtonColor: '#3085d6',
                                cancelButtonColor: '#d33',
                                confirmButtonText: 'Archieve & Delete'
                            }).then((result) => {
                                if (result.value) {
                                    e.preventDefault();
                                    showMask();
                                    if (itemlist.length > 0) {

                                        $.get("/connector/DeleteRecordsReviewedByUser?id=" + parseInt(connectorid) + "&itemlist=" + itemlist + "&ctid=" + ctid, function (data) {
                                            //hideMask();
                                            console.log(data);
                                            //window.location.reload();
                                            GetChildRecord(parseInt(connectorid), ctid);

                                        })

                                    }
                                    //hideMask();
                                }
                            });
                        }
                        else {
                            Swal.fire({
                                //title: 'Are you sure?',
                                text: "Selected " + count + " items will be permanently deleted from Destination since you have not selected the backup option in Process configuration",
                                icon: 'error',
                                showCancelButton: true,
                                confirmButtonColor: '#3085d6',
                                cancelButtonColor: '#d33',
                                confirmButtonText: 'Delete permanently'
                            }).then((result) => {
                                if (result.value) {
                                    e.preventDefault();
                                    showMask();
                                    if (itemlist.length > 0) {

                                        $.get("/connector/DeleteRecordsReviewedByUser?id=" + parseInt(connectorid) + "&itemlist=" + itemlist + "&ctid=" + ctid, function (data) {
                                            //hideMask();
                                            console.log(data);
                                            //window.location.reload();
                                            GetChildRecord(parseInt(connectorid), ctid);

                                        })
                                    }
                                    //hideMask();
                                }
                            });
                        }
                    }
                });

                $(".fa-times").click(function () {

                    //window.location.href = "/connector/getrows/" + parseInt(connectorid);
                    var ctid = "";
                    GetChildRecord(parseInt(connectorid), ctid)
                });

                $("#Records").change(function () {
                    if ($(".current")[0] != undefined) {
                        var currentpage = "1";
                        localStorage.setItem("currentpage", currentpage);
                    }
                    showMask();
                    $.ajax({
                        url: "/connector/GetRecordsByPageSize/" + connectorid + "?pagesize=" + parseInt($('#Records :selected').text()),
                        method: "GET",
                        error: function (xhr, status, error) {
                            hideMask();
                            console.log(xhr);
                            console.log(status);
                            if (status == "timeout") {
                                container.find("tr[name=emptyrow] td").html("Request timeout!");
                            }
                        },
                        success: function (data) {
                            var container = $("div[name=etrows]");
                            var pagesize = $('#Records :selected').text();
                            localStorage.setItem("pagesize", pagesize);
                            container.html("");
                            container.html(data);
                            //container.attr("data-isrowsread", "true");
                            $('#Records').val(pagesize);
                            //$("#UniqueRecords").val(pagesize);
                            var ctid = "";
                            getTabs(ctid);
                            checkrecords();
                            hideMask();
                        }
                    });

                });
                $("#UniqueRecords").change(function () {
                    var tab = $("#tabs .ui-tabs-active")[0].children[0].id;
                    showMask();
                    $.ajax({
                        url: "/connector/GetRecordsByPageSize/" + connectorid + "?pagesize=" + parseInt($('#UniqueRecords :selected').text()) + "&tab=" + tab,
                        method: "GET",
                        error: function (xhr, status, error) {
                            hideMask();
                            console.log(xhr);
                            console.log(status);
                            if (status == "timeout") {
                                container.find("tr[name=emptyrow] td").html("Request timeout!");
                            }
                        },
                        success: function (data) {
                            var container = $("div[name=etrows]");
                            var pagesize = $('#UniqueRecords :selected').text();
                            localStorage.setItem("pagesize2", pagesize);
                            container.html("");
                            container.html(data);
                            //container.attr("data-isrowsread", "true");
                            $('#UniqueRecords').val(pagesize);
                            $("#tabs").tabs({ active: 1 });

                            var ctid = "";
                            getTabs(ctid);
                            checkrecords();
                            $("#kt_table_2").DataTable().columns.adjust().draw();
                            $("#kt_table_2").DataTable().draw();
                            var headerrow = $("table > thead > tr")[2];

                            headerrow.children[0].className = "";
                            headerrow.children[0].style.width = "40px";
                            $("#kt_table_2").DataTable().columns.adjust().draw();
                            $("#kt_table_2").DataTable().draw();
                            if ($("#kt_table_2 > thead > tr")[0].children.length > 7) {
                                $('.dataTables_scrollBody')[1].style.width = "1280px";
                                $('.dataTables_scrollHead')[1].style.width = "1280px";

                                var length = $(".DTFC_Cloned > thead > tr > th").length;
                                for (var i = 0; i < length; i++) {

                                    if ($(".DTFC_Cloned > thead > tr > th")[i].getAttribute('aria-controls') == "kt_table_2" && $(".DTFC_Cloned > thead > tr > th")[i].style.paddingTop != "0px") {
                                        $(".DTFC_Cloned > thead > tr > th")[i].className = "";


                                    }
                                }
                                var length2 = $(".DTFC_LeftBodyLiner").children().length;
                                for (var j = 0; j < length2; j++) {

                                    if ($(".DTFC_LeftBodyLiner").children()[j].getAttribute('aria-describedby') == "kt_table_2_info") {
                                        var fixedcolumn = $(".DTFC_LeftBodyLiner").children()[j];
                                        fixedcolumn.children[0].children[0].children[0].className = "";

                                    }
                                }
                            }
                            var currentpage = parseInt($(".current")[0].innerText);
                            var totalrecords = $("#totalrecordcount").text().trim();
                            var pagesize = $('#UniqueRecords :selected').text();

                            var currentpagerecord = currentpage * pagesize;

                            if (currentpagerecord > totalrecords) {

                                currentpagerecord = totalrecords;
                            }
                            $("#kt_table_2_info").text("Showing " + (currentpage * pagesize - pagesize + 1) + " to " + currentpagerecord + " of " + totalrecords + " entries");

                            hideMask();
                        }
                    });

                });
                $("#DuplicateRecords").change(function () {
                    var tab = $("#tabs .ui-tabs-active")[0].children[0].id;
                    var ctid = $("#ctidvalue")[0].value;
                    showMask();
                    $.ajax({
                        url: "/connector/GetRecordsByPageSize/" + connectorid + "?pagesize=" + parseInt($('#DuplicateRecords :selected').text()) + "&ctid=" + ctid,
                        method: "GET",
                        error: function (xhr, status, error) {
                            hideMask();
                            console.log(xhr);
                            console.log(status);
                            if (status == "timeout") {
                                container.find("tr[name=emptyrow] td").html("Request timeout!");
                            }
                        },
                        success: function (data) {
                            var container = $("div[name=etrows]");
                            var pagesize = $('#DuplicateRecords :selected').text();
                            localStorage.setItem("pagesize3", pagesize);
                            container.html("");
                            container.html(data);
                            //container.attr("data-isrowsread", "true");
                            $('#DuplicateRecords').val(pagesize);

                            getTabs(ctid);
                            checkrecords();

                            var currentpage = parseInt($(".current")[0].innerText);
                            var totalrecords = $("#totalrecordcount").text().trim();
                            //var pagesize = $('#DuplicateRecords :selected').text();

                            var currentpagerecord = currentpage * pagesize;

                            if (currentpagerecord > totalrecords) {

                                currentpagerecord = totalrecords;
                            }
                            $("#kt_table_2_info").text("Showing " + (currentpage * pagesize - pagesize + 1) + " to " + currentpagerecord + " of " + totalrecords + " entries");

                            hideMask();
                        }
                    });

                });
            }
            function GetChildRecord(connectorid, ctid) {

                if (ctid == "" || ctid == null) {
                    var pagesize = localStorage.getItem("pagesize");
                    if (pagesize == null) {

                        pagesize = "10";
                    }

                    var currentpage = localStorage.getItem("currentpage");
                    if (currentpage == null) {

                        currentpage = "1";
                    }
                }
                else {
                    var pagesize = localStorage.getItem("pagesize3");
                    if (pagesize == null) {

                        pagesize = "10";
                    }
                    var currentpage = "1";
                }
                showMask();

                $.ajax({
                    url: "/connector/GetDuplicateRecord/" + connectorid + "?ctid=" + ctid + "&pagesize=" + parseInt(pagesize) + "&currentpage=" + parseInt(currentpage),
                    method: "GET",
                    error: function (xhr, status, error) {
                        hideMask();
                        console.log(xhr);
                        console.log(status);
                        if (status == "timeout") {
                            container.find("tr[name=emptyrow] td").html("Request timeout!");
                        }
                    },
                    success: function (data) {
                        var container = $("div[name=etrows]");
                        container.html("");
                        container.html(data);
                        //container.attr("data-isrowsread", "true");
                        $('#DuplicateRecords').val(pagesize);
                        $('#UniqueRecords').val(pagesize);
                        $('#Records').val(pagesize);
                        getTabs(ctid);
                        checkrecords();
                        hideMask();
                    }
                });
            }

            function updatePaging(container) {

                if ($ && container) {
                    $(container).find("ul.pagination")
                        .addClass("pagination pagination-sm no-margin pull-right")
                    $(container).find(".box-body .header").click(function () {
                        $header = $(this);
                        $content = $header.next();
                        $content.slideToggle(200, function () {
                            if ($header.find("i").hasClass("collapse")) {

                                var container = $(this).closest("div[name=etrows]");
                                if ($("span[data-rowcount]")) {

                                    if (container.attr("data-isrowsread") && container.attr("data-isrowsread").toLowerCase() == "false") {
                                        showMask();
                                        $.ajax({
                                            url: "/connector/getsyncrecordsbypageno/" + container.attr("id") + "?page=1",
                                            method: "GET",
                                            error: function (xhr, status, error) {
                                                hideMask();
                                                console.log(xhr);
                                                console.log(status);
                                                if (status == "timeout") {
                                                    container.find("tr[name=emptyrow] td").html("Request timeout!");
                                                }
                                            },
                                            success: function (data) {
                                                alert();
                                                container.html(data);
                                                container.attr("data-isrowsread", "true");

                                                hideMask();
                                            }
                                        });
                                    }
                                }
                                $header.find("i").removeClass("collapse");
                                $header.find("i").addClass("expand");
                            }
                            else {
                                $header.find("i").removeClass("expand");
                                $header.find("i").addClass("collapse");
                            }
                            $header.find("i:last").css({ marginTop: "-10px" });
                        });
                    })
                    $(container).find("ul.pagination li a").each(function () {
                        var aTag = $(this);
                        var id = $(this).closest("ul").attr("data-id");
                        var pageNo = aTag.attr('href').match(numRegex);
                        var aHref = aTag.attr('href').match(charRegex);

                        //if (pageNo[0] == null) {

                        //    pageNo[0] = "1";
                        //}

                        if (id && aHref.length > 0 && pageNo.length > 0) {

                            if ($("#tabs .ui-tabs-active").text() == "Unique Records") {
                                var tab = $("#tabs .ui-tabs-active")[0].children[0].id;
                                //var pagesize = $('#UniqueRecords :selected').text();
                                var pagesize = localStorage.getItem("pagesize2");
                                if (pagesize == null) {

                                    pagesize = "10";
                                }
                                aTag.attr('href', aHref[0] + id + '?page=' + parseInt(pageNo[0]) + '&tab=' + tab + '&pagesize=' + parseInt(pagesize));
                            }
                            else if ($("#tabs .ui-tabs-active").text() == "Duplicate Records") {
                                var ctid = $("#ctidvalue")[0].value;
                                //var pagesize = $('#DuplicateRecords :selected').text();
                                var pagesize = localStorage.getItem("pagesize3");
                                if (pagesize == null) {

                                    pagesize = "10";
                                }
                                aTag.attr('href', aHref[0] + id + '?page=' + parseInt(pageNo[0]) + '&ctid=' + ctid + '&pagesize=' + parseInt(pagesize));

                            }
                            else {
                                //var pagesize = $('#Records :selected').text();
                                var pagesize = localStorage.getItem("pagesize");

                                if (pagesize == null) {

                                    pagesize = "10";
                                }
                                aTag.attr('href', aHref[0] + id + '?page=' + parseInt(pageNo[0]) + '&pagesize=' + parseInt(pagesize));
                            }
                        }

                    });
                    $(container).find("ul.pagination").on("click", "li a", function (e) {
                        e.preventDefault();
                        e.stopPropagation();
                        showMask();
                        var container = $(this).closest("div[name=etrows]");
                        $.ajax({
                            url: $(this).attr("href"),
                            method: "GET",
                            error: function (xhr, status, error) {
                                hideMask();
                                console.log(xhr);
                                console.log(status);
                                if (status == "timeout") {
                                    container.find("tr[name=emptyrow] td").html("Request timeout!");
                                }
                            },
                            success: function (data) {
                                var ctid = "";
                                var activetab = $("#tabs .ui-tabs-active").text();
                                var pagesize = $('#Records :selected').text();
                                var pagesize2 = $('#UniqueRecords :selected').text();
                                var pagesize3 = $('#DuplicateRecords :selected').text();

                                if (activetab == "Duplicate Records") {
                                    ctid = $("#ctidvalue")[0].value;
                                }
                                var tab = $("#tabs .ui-tabs-active")[0].children[0].id;
                                container.html(data);
                                //updatePaging(container);
                                $(container).find(".box-body .header").click();

                                if (activetab == "Unique Records") {
                                    $("#tabs").tabs({ active: 1 });
                                    $('#UniqueRecords').val(pagesize2);

                                }
                                if (activetab == "Duplicate Records") {

                                    //GetChildRecord(parseInt(connectorid), ctid)

                                    //$("#tabs").tabs({ active: 2 });
                                    $('#DuplicateRecords').val(pagesize3);

                                    getTabs(ctid);

                                    checkrecords();
                                }
                                else {
                                    var currentpage = $(".current")[0].innerText;
                                    if (activetab == "Duplicate Groups") {
                                        localStorage.setItem("currentpage", currentpage);
                                    }
                                    var ctid = "";
                                    $('#Records').val(pagesize);
                                    getTabs(ctid);
                                    checkrecords();
                                }
                                if (activetab == "Unique Records") {

                                    $("#kt_table_2").DataTable().columns.adjust().draw();
                                    $("#kt_table_2").DataTable().draw();
                                    var headerrow = $("table > thead > tr")[2];

                                    headerrow.children[0].className = "";
                                    headerrow.children[0].style.width = "40px";
                                    $("#kt_table_2").DataTable().columns.adjust().draw();
                                    $("#kt_table_2").DataTable().draw();
                                    if ($("#kt_table_2 > thead > tr")[0].children.length > 7) {
                                        $('.dataTables_scrollBody')[1].style.width = "1280px";
                                        $('.dataTables_scrollHead')[1].style.width = "1280px";

                                        var length = $(".DTFC_Cloned > thead > tr > th").length;
                                        for (var i = 0; i < length; i++) {

                                            if ($(".DTFC_Cloned > thead > tr > th")[i].getAttribute('aria-controls') == "kt_table_2" && $(".DTFC_Cloned > thead > tr > th")[i].style.paddingTop != "0px") {
                                                $(".DTFC_Cloned > thead > tr > th")[i].className = "";


                                            }
                                        }
                                        var length2 = $(".DTFC_LeftBodyLiner").children().length;
                                        for (var j = 0; j < length2; j++) {

                                            if ($(".DTFC_LeftBodyLiner").children()[j].getAttribute('aria-describedby') == "kt_table_2_info") {
                                                var fixedcolumn = $(".DTFC_LeftBodyLiner").children()[j];
                                                fixedcolumn.children[0].children[0].children[0].className = "";

                                            }
                                        }
                                    }
                                    var currentpage = parseInt($(".current")[0].innerText);
                                    var totalrecords = $("#totalrecordcount").text().trim();
                                    var pagesize = $('#UniqueRecords :selected').text();

                                    var currentpagerecord = currentpage * pagesize;

                                    if (currentpagerecord > totalrecords) {

                                        currentpagerecord = totalrecords;
                                    }
                                    $("#kt_table_2_info").text("Showing " + (currentpage * pagesize - pagesize + 1) + " to " + currentpagerecord + " of " + totalrecords + " entries");

                                }
                                hideMask();
                            }
                            //timeout: 60000 // sets timeout to 1 min
                        });
                    });
                }
                var currentpage = parseInt($(".current")[0].innerText);
                var totalrecords = $("#totalrecordcount").text().trim();
                //var pagesize = $('#Records :selected').text();
                var pagesize = localStorage.getItem("pagesize");
                if (pagesize == null) {

                    pagesize = "10";
                }
                var pagesize2 = localStorage.getItem("pagesize2");
                if (pagesize2 == null) {

                    pagesize2 = "10";
                }
                $('#Records').val(pagesize);
                $("#UniqueRecords").val(pagesize2);
                var currentpagerecord = currentpage * pagesize;
                var currentpagerecord2 = currentpage * pagesize2;

                if (currentpagerecord > totalrecords) {

                    currentpagerecord = totalrecords;
                }
                if (currentpagerecord2 > totalrecords) {

                    currentpagerecord2 = totalrecords;
                }
                $("#kt_table_1_info").text("Showing " + (currentpage * pagesize - pagesize + 1) + " to " + currentpagerecord + " of " + totalrecords + " entries");
                $("#kt_table_2_info").text("Showing " + (currentpage * pagesize2 - pagesize2 + 1) + " to " + currentpagerecord2 + " of " + totalrecords + " entries");

            }

            $(function () {
                var ctid = "";
                getTabs(ctid);
                checkrecords()
            });
        </script>
    }
